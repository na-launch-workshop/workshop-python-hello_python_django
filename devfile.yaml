schemaVersion: 2.2.2
metadata:
  name: workshop-python-hello_python_django
  version: 1.0.0
  description: DevSpaces workspace for Django hello world translations app
attributes:
  che-editor: vscode
components:
  - name: tools
    container:
      image: image-registry.openshift-image-registry.svc:5000/openshift/udi-rhel9:3.22
      endpoints:
        - exposure: public
          name: hello-by-lang
          protocol: https
          targetPort: 8080
          path: /
      cpuLimit: '4'
      cpuRequest: '1'
      memoryLimit: '8G'
      memoryRequest: '4G'
      mountSources: true
commands:
  - id: 1-install
    exec:
      label: "1. Install dependencies"
      component: tools
      workingDir: ${PROJECT_SOURCE}
      commandLine: "[ -d .venv ] || python3 -m venv .venv; . .venv/bin/activate; pip install -r requirements-dev.txt"
      group:
        kind: build
        isDefault: true
  - id: 2-test
    exec:
      label: "2. Run tests"
      component: tools
      workingDir: ${PROJECT_SOURCE}
      commandLine: ". .venv/bin/activate; python -m pytest"
      group:
        kind: test
        isDefault: true
  - id: 3-start
    exec:
      label: "3. Start development server"
      component: tools
      workingDir: ${PROJECT_SOURCE}
      commandLine: ". .venv/bin/activate; python manage.py runserver 0.0.0.0:8080"
      group:
        kind: run
        isDefault: true
